{"version":3,"file":"store.js","sources":["../src/store.ts"],"sourcesContent":["export type Action<P = any> = { type?: string, payload?: P }\n\nexport type Dispatch = <A extends Action>(action: A) => any\n\nexport type Reducer<S = any, A = Action> = (state: S, action: A) => S\n\nexport type StoreEvent = { action: Action }\n\nexport class Store<S> extends EventTarget {\n  constructor(public state: S, public reducer: Reducer<S>) {\n    super()\n    this.state = this.reducer(this.state, {})\n  }\n\n  dispatch(action: Action) {\n    const evt = new CustomEvent<StoreEvent>('dispatch', {\n      cancelable: true,\n      detail: { action },\n    })\n\n    if (this.dispatchEvent(evt)) {\n      action = evt.detail.action\n      this.state = this.reducer(this.state, action)\n      this.dispatchEvent(new CustomEvent<StoreEvent>('state', {\n        detail: { action },\n      }))\n    }\n\n    return action\n  }\n}\n"],"names":["Store","EventTarget","[object Object]","state","reducer","super","this","action","evt","CustomEvent","cancelable","detail","dispatchEvent"],"mappings":"MAQaA,UAAiBC,YAC5BC,YAAmBC,EAAiBC,GAClCC,QADiBC,WAAAH,EAAiBG,aAAAF,EAElCE,KAAKH,MAAQG,KAAKF,QAAQE,KAAKH,MAAO,IAGxCD,SAASK,GACP,MAAMC,EAAM,IAAIC,YAAwB,WAAY,CAClDC,YAAY,EACZC,OAAQ,CAAEJ,OAAAA,KAWZ,OARID,KAAKM,cAAcJ,KACrBD,EAASC,EAAIG,OAAOJ,OACpBD,KAAKH,MAAQG,KAAKF,QAAQE,KAAKH,MAAOI,GACtCD,KAAKM,cAAc,IAAIH,YAAwB,QAAS,CACtDE,OAAQ,CAAEJ,OAAAA,OAIPA"}