"use strict";function combineReducers(t){return(e={},s)=>{for(const n in t)e[n]=t[n](e[n],s);return e}}Object.defineProperty(exports,"__esModule",{value:!0});const dispatchEvent="dispatch",stateEvent="state",dispatchMap=Symbol(),createDispatchMap=Symbol(),addEventListeners=Symbol(),removeEventListeners=Symbol(),addStateSubscription=Symbol(),removeStateSubscription=Symbol(),onStateChange=Symbol();function connect(t,e){return class extends e{constructor(...t){super(...t),this[onStateChange]=this[onStateChange].bind(this),this[createDispatchMap]()}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this[addEventListeners](),this[addStateSubscription]()}disconnectedCallback(){this[removeStateSubscription](),this[removeEventListeners](),super.disconnectedCallback&&super.disconnectedCallback()}[createDispatchMap](){if(this[dispatchMap]={},this.mapEvents){const e=this.mapEvents();for(const s in e){const n=e[s];this[dispatchMap][s]=function(e){t.dispatch(n(e))}.bind(this)}}}[addEventListeners](){for(const t in this[dispatchMap])this.addEventListener(t,this[dispatchMap][t],!1)}[removeEventListeners](){for(const t in this[dispatchMap])this.removeEventListener(t,this[dispatchMap][t],!1)}[addStateSubscription](){t.addEventListener(stateEvent,this[onStateChange]),this[onStateChange]()}[removeStateSubscription](){this.removeEventListener(stateEvent,this[onStateChange])}[onStateChange](){this.mapState&&Object.assign(this,this.mapState(t.state))}}}function devtools(t){const e=window.__REDUX_DEVTOOLS_EXTENSION__;if(e){const s=e.connect();let n=!1;t.addEventListener(stateEvent,e=>{const{action:a}=e.detail;n?n=!1:s.send(a,t.state)}),s.subscribe(e=>{"DISPATCH"===e.type&&e.state&&(n=!0,t.state=JSON.parse(e.state),t.dispatch({}))}),s.init(t.state)}return t}function persist(t,e){const s={name:location.hostname,filter:t=>!0,persist:t=>t,delay:0,...e},n=localStorage.getItem(s.name);n&&(t.state={...t.state,...JSON.parse(n)});let a=0;return t.addEventListener(stateEvent,e=>{const n=e,{action:i}=n.detail;s.filter(i)&&(a&&window.clearTimeout(a),a=window.setTimeout(()=>{localStorage.setItem(s.name,JSON.stringify(s.persist(t.state))),a=0},s.delay))}),t}class Store extends EventTarget{constructor(t,e){super(),this.state=t,this.reducer=e,this.state=this.reducer(this.state,{})}dispatch(t){const e=new CustomEvent(dispatchEvent,{cancelable:!0,detail:{action:t}});return this.dispatchEvent(e)&&(t=e.detail.action,this.state=this.reducer(this.state,t),this.dispatchEvent(new CustomEvent(stateEvent,{detail:{action:t}}))),t}}function thunk(t){const e=t.dispatch.bind(t);return t.addEventListener(dispatchEvent,s=>{const n=s,{action:a}=n.detail;if("function"==typeof a){a(e,t.state),n.stopImmediatePropagation(),n.preventDefault()}}),t}exports.Store=Store,exports.combineReducers=combineReducers,exports.connect=connect,exports.devtools=devtools,exports.persist=persist,exports.thunk=thunk;
